var myList = {
   "name":"home",
   "type":"folder",
   "path":"home",
   "items":[
      {
         "name":"LICENSE",
         "type":"file",
         "path":"home/LICENSE",
         "size":1082
      },
      {
         "name":"Readme.md",
         "type":"file",
         "path":"home/Readme.md",
         "size":1331
      },
      {
         "name":"cute-files.js",
         "type":"file",
         "path":"home/cute-files.js",
         "size":1355
      },
      {
         "name":"files_my",
         "type":"folder",
         "path":"home/files_my",
         "items":[
            {
               "name":"dd.py",
               "type":"file",
               "path":"home/files_my/dd.py",
               "size":32
            },
            {
               "name":"f2",
               "type":"folder",
               "path":"home/files_my/f2",
               "items":[
                  {
                     "name":"f22",
                     "type":"folder",
                     "path":"home/files_my/f2/f22",
                     "items":[
                        {
                           "name":"test.py",
                           "type":"file",
                           "path":"home/files_my/f2/f22/test.py",
                           "size":7013
                        }
                     ]
                  }
               ]
            },
            {
               "name":"place your files here",
               "type":"file",
               "path":"home/files_my/place your files here",
               "size":0
            },
            {
               "name":"pp.cpp",
               "type":"file",
               "path":"home/files_my/pp.cpp",
               "size":26
            },
            {
               "name":"sss.c",
               "type":"file",
               "path":"home/files_my/sss.c",
               "size":71
            },
            {
               "name":"t.py",
               "type":"file",
               "path":"home/files_my/t.py",
               "size":81
            },
            {
               "name":"test",
               "type":"folder",
               "path":"home/files_my/test",
               "items":[
                  {
                     "name":"f2",
                     "type":"folder",
                     "path":"home/files_my/test/f2",
                     "items":[
                        {
                           "name":"fromterm_with_love",
                           "type":"file",
                           "path":"home/files_my/test/f2/fromterm_with_love",
                           "size":53
                        }
                     ]
                  },
                  {
                     "name":"hi",
                     "type":"folder",
                     "path":"home/files_my/test/hi",
                     "items":[
                        {
                           "name":"hi2",
                           "type":"folder",
                           "path":"home/files_my/test/hi/hi2",
                           "items":[
                              {
                                 "name":"test.cpp",
                                 "type":"file",
                                 "path":"home/files_my/test/hi/hi2/test.cpp",
                                 "size":0
                              },
                              {
                                 "name":"treeOps.cpp",
                                 "type":"file",
                                 "path":"home/files_my/test/hi/hi2/treeOps.cpp",
                                 "size":17158
                              }
                           ]
                        }
                     ]
                  },
                  {
                     "name":"jk",
                     "type":"folder",
                     "path":"home/files_my/test/jk",
                     "items":[

                     ]
                  },
                  {
                     "name":"pp.c",
                     "type":"file",
                     "path":"home/files_my/test/pp.c",
                     "size":8
                  }
               ]
            },
            {
               "name":"wish_a",
               "type":"file",
               "path":"home/files_my/wish_a",
               "size":122
            }
         ]
      },
      {
         "name":"frontend",
         "type":"folder",
         "path":"home/frontend",
         "items":[
            {
               "name":"assets",
               "type":"folder",
               "path":"home/frontend/assets",
               "items":[
                  {
                     "name":"css",
                     "type":"folder",
                     "path":"home/frontend/assets/css",
                     "items":[
                        {
                           "name":"styles.css",
                           "type":"file",
                           "path":"home/frontend/assets/css/styles.css",
                           "size":8354
                        }
                     ]
                  },
                  {
                     "name":"js",
                     "type":"folder",
                     "path":"home/frontend/assets/js",
                     "items":[
                        {
                           "name":"script.js",
                           "type":"file",
                           "path":"home/frontend/assets/js/script.js",
                           "size":11034
                        }
                     ]
                  }
               ]
            },
            {
               "name":"index.html",
               "type":"file",
               "path":"home/frontend/index.html",
               "size":767
            }
         ]
      },
      {
         "name":"node_modules",
         "type":"folder",
         "path":"home/node_modules",
         "items":[
            {
               "name":"commander",
               "type":"folder",
               "path":"home/node_modules/commander",
               "items":[
                  {
                     "name":"History.md",
                     "type":"file",
                     "path":"home/node_modules/commander/History.md",
                     "size":6521
                  },
                  {
                     "name":"LICENSE",
                     "type":"file",
                     "path":"home/node_modules/commander/LICENSE",
                     "size":1098
                  },
                  {
                     "name":"Readme.md",
                     "type":"file",
                     "path":"home/node_modules/commander/Readme.md",
                     "size":10119
                  },
                  {
                     "name":"index.js",
                     "type":"file",
                     "path":"home/node_modules/commander/index.js",
                     "size":24714
                  },
                  {
                     "name":"package.json",
                     "type":"file",
                     "path":"home/node_modules/commander/package.json",
                     "size":2219
                  }
               ]
            },
            {
               "name":"cookie-signature",
               "type":"folder",
               "path":"home/node_modules/cookie-signature",
               "items":[
                  {
                     "name":"History.md",
                     "type":"file",
                     "path":"home/node_modules/cookie-signature/History.md",
                     "size":695
                  },
                  {
                     "name":"Readme.md",
                     "type":"file",
                     "path":"home/node_modules/cookie-signature/Readme.md",
                     "size":1490
                  },
                  {
                     "name":"index.js",
                     "type":"file",
                     "path":"home/node_modules/cookie-signature/index.js",
                     "size":1230
                  },
                  {
                     "name":"package.json",
                     "type":"file",
                     "path":"home/node_modules/cookie-signature/package.json",
                     "size":2158
                  }
               ]
            },
            {
               "name":"express",
               "type":"folder",
               "path":"home/node_modules/express",
               "items":[
                  {
                     "name":"History.md",
                     "type":"file",
                     "path":"home/node_modules/express/History.md",
                     "size":102583
                  },
                  {
                     "name":"LICENSE",
                     "type":"file",
                     "path":"home/node_modules/express/LICENSE",
                     "size":1249
                  },
                  {
                     "name":"Readme.md",
                     "type":"file",
                     "path":"home/node_modules/express/Readme.md",
                     "size":4540
                  },
                  {
                     "name":"index.js",
                     "type":"file",
                     "path":"home/node_modules/express/index.js",
                     "size":224
                  },
                  {
                     "name":"lib",
                     "type":"folder",
                     "path":"home/node_modules/express/lib",
                     "items":[
                        {
                           "name":"application.js",
                           "type":"file",
                           "path":"home/node_modules/express/lib/application.js",
                           "size":14263
                        },
                        {
                           "name":"express.js",
                           "type":"file",
                           "path":"home/node_modules/express/lib/express.js",
                           "size":2217
                        },
                        {
                           "name":"middleware",
                           "type":"folder",
                           "path":"home/node_modules/express/lib/middleware",
                           "items":[
                              {
                                 "name":"init.js",
                                 "type":"file",
                                 "path":"home/node_modules/express/lib/middleware/init.js",
                                 "size":850
                              },
                              {
                                 "name":"query.js",
                                 "type":"file",
                                 "path":"home/node_modules/express/lib/middleware/query.js",
                                 "size":863
                              }
                           ]
                        },
                        {
                           "name":"request.js",
                           "type":"file",
                           "path":"home/node_modules/express/lib/request.js",
                           "size":12213
                        },
                        {
                           "name":"response.js",
                           "type":"file",
                           "path":"home/node_modules/express/lib/response.js",
                           "size":25155
                        },
                        {
                           "name":"router",
                           "type":"folder",
                           "path":"home/node_modules/express/lib/router",
                           "items":[
                              {
                                 "name":"index.js",
                                 "type":"file",
                                 "path":"home/node_modules/express/lib/router/index.js",
                                 "size":14880
                              },
                              {
                                 "name":"layer.js",
                                 "type":"file",
                                 "path":"home/node_modules/express/lib/router/layer.js",
                                 "size":3296
                              },
                              {
                                 "name":"route.js",
                                 "type":"file",
                                 "path":"home/node_modules/express/lib/router/route.js",
                                 "size":4149
                              }
                           ]
                        },
                        {
                           "name":"utils.js",
                           "type":"file",
                           "path":"home/node_modules/express/lib/utils.js",
                           "size":5824
                        },
                        {
                           "name":"view.js",
                           "type":"file",
                           "path":"home/node_modules/express/lib/view.js",
                           "size":3190
                        }
                     ]
                  },
                  {
                     "name":"node_modules",
                     "type":"folder",
                     "path":"home/node_modules/express/node_modules",
                     "items":[
                        {
                           "name":"content-disposition",
                           "type":"folder",
                           "path":"home/node_modules/express/node_modules/content-disposition",
                           "items":[
                              {
                                 "name":"HISTORY.md",
                                 "type":"file",
                                 "path":"home/node_modules/express/node_modules/content-disposition/HISTORY.md",
                                 "size":866
                              },
                              {
                                 "name":"LICENSE",
                                 "type":"file",
                                 "path":"home/node_modules/express/node_modules/content-disposition/LICENSE",
                                 "size":1089
                              },
                              {
                                 "name":"README.md",
                                 "type":"file",
                                 "path":"home/node_modules/express/node_modules/content-disposition/README.md",
                                 "size":5148
                              },
                              {
                                 "name":"index.js",
                                 "type":"file",
                                 "path":"home/node_modules/express/node_modules/content-disposition/index.js",
                                 "size":10399
                              },
                              {
                                 "name":"package.json",
                                 "type":"file",
                                 "path":"home/node_modules/express/node_modules/content-disposition/package.json",
                                 "size":2895
                              }
                           ]
                        }
                     ]
                  },
                  {
                     "name":"package.json",
                     "type":"file",
                     "path":"home/node_modules/express/package.json",
                     "size":4804
                  }
               ]
            },
            {
               "name":"fresh",
               "type":"folder",
               "path":"home/node_modules/fresh",
               "items":[
                  {
                     "name":"HISTORY.md",
                     "type":"file",
                     "path":"home/node_modules/fresh/HISTORY.md",
                     "size":1220
                  },
                  {
                     "name":"LICENSE",
                     "type":"file",
                     "path":"home/node_modules/fresh/LICENSE",
                     "size":1174
                  },
                  {
                     "name":"README.md",
                     "type":"file",
                     "path":"home/node_modules/fresh/README.md",
                     "size":3236
                  },
                  {
                     "name":"index.js",
                     "type":"file",
                     "path":"home/node_modules/fresh/index.js",
                     "size":1740
                  },
                  {
                     "name":"package.json",
                     "type":"file",
                     "path":"home/node_modules/fresh/package.json",
                     "size":2890
                  }
               ]
            },
            {
               "name":"methods",
               "type":"folder",
               "path":"home/node_modules/methods",
               "items":[
                  {
                     "name":"HISTORY.md",
                     "type":"file",
                     "path":"home/node_modules/methods/HISTORY.md",
                     "size":427
                  },
                  {
                     "name":"LICENSE",
                     "type":"file",
                     "path":"home/node_modules/methods/LICENSE",
                     "size":1180
                  },
                  {
                     "name":"README.md",
                     "type":"file",
                     "path":"home/node_modules/methods/README.md",
                     "size":1694
                  },
                  {
                     "name":"index.js",
                     "type":"file",
                     "path":"home/node_modules/methods/index.js",
                     "size":1040
                  },
                  {
                     "name":"package.json",
                     "type":"file",
                     "path":"home/node_modules/methods/package.json",
                     "size":2828
                  }
               ]
            },
            {
               "name":"mime",
               "type":"folder",
               "path":"home/node_modules/mime",
               "items":[
                  {
                     "name":"LICENSE",
                     "type":"file",
                     "path":"home/node_modules/mime/LICENSE",
                     "size":1075
                  },
                  {
                     "name":"README.md",
                     "type":"file",
                     "path":"home/node_modules/mime/README.md",
                     "size":2119
                  },
                  {
                     "name":"build",
                     "type":"folder",
                     "path":"home/node_modules/mime/build",
                     "items":[
                        {
                           "name":"build.js",
                           "type":"file",
                           "path":"home/node_modules/mime/build/build.js",
                           "size":231
                        },
                        {
                           "name":"test.js",
                           "type":"file",
                           "path":"home/node_modules/mime/build/test.js",
                           "size":2184
                        }
                     ]
                  },
                  {
                     "name":"cli.js",
                     "type":"file",
                     "path":"home/node_modules/mime/cli.js",
                     "size":149
                  },
                  {
                     "name":"mime.js",
                     "type":"file",
                     "path":"home/node_modules/mime/mime.js",
                     "size":2671
                  },
                  {
                     "name":"package.json",
                     "type":"file",
                     "path":"home/node_modules/mime/package.json",
                     "size":2300
                  },
                  {
                     "name":"types.json",
                     "type":"file",
                     "path":"home/node_modules/mime/types.json",
                     "size":29681
                  }
               ]
            },
            {
               "name":"qs",
               "type":"folder",
               "path":"home/node_modules/qs",
               "items":[
                  {
                     "name":"CHANGELOG.md",
                     "type":"file",
                     "path":"home/node_modules/qs/CHANGELOG.md",
                     "size":10370
                  },
                  {
                     "name":"LICENSE",
                     "type":"file",
                     "path":"home/node_modules/qs/LICENSE",
                     "size":1654
                  },
                  {
                     "name":"README.md",
                     "type":"file",
                     "path":"home/node_modules/qs/README.md",
                     "size":13292
                  },
                  {
                     "name":"dist",
                     "type":"folder",
                     "path":"home/node_modules/qs/dist",
                     "items":[
                        {
                           "name":"qs.js",
                           "type":"file",
                           "path":"home/node_modules/qs/dist/qs.js",
                           "size":18185
                        }
                     ]
                  },
                  {
                     "name":"lib",
                     "type":"folder",
                     "path":"home/node_modules/qs/lib",
                     "items":[
                        {
                           "name":"formats.js",
                           "type":"file",
                           "path":"home/node_modules/qs/lib/formats.js",
                           "size":387
                        },
                        {
                           "name":"index.js",
                           "type":"file",
                           "path":"home/node_modules/qs/lib/index.js",
                           "size":211
                        },
                        {
                           "name":"parse.js",
                           "type":"file",
                           "path":"home/node_modules/qs/lib/parse.js",
                           "size":5492
                        },
                        {
                           "name":"stringify.js",
                           "type":"file",
                           "path":"home/node_modules/qs/lib/stringify.js",
                           "size":6086
                        },
                        {
                           "name":"utils.js",
                           "type":"file",
                           "path":"home/node_modules/qs/lib/utils.js",
                           "size":4891
                        }
                     ]
                  },
                  {
                     "name":"package.json",
                     "type":"file",
                     "path":"home/node_modules/qs/package.json",
                     "size":2888
                  },
                  {
                     "name":"test",
                     "type":"folder",
                     "path":"home/node_modules/qs/test",
                     "items":[
                        {
                           "name":"index.js",
                           "type":"file",
                           "path":"home/node_modules/qs/test/index.js",
                           "size":81
                        },
                        {
                           "name":"parse.js",
                           "type":"file",
                           "path":"home/node_modules/qs/test/parse.js",
                           "size":20702
                        },
                        {
                           "name":"stringify.js",
                           "type":"file",
                           "path":"home/node_modules/qs/test/stringify.js",
                           "size":19832
                        },
                        {
                           "name":"utils.js",
                           "type":"file",
                           "path":"home/node_modules/qs/test/utils.js",
                           "size":1073
                        }
                     ]
                  }
               ]
            },
            {
               "name":"range-parser",
               "type":"folder",
               "path":"home/node_modules/range-parser",
               "items":[
                  {
                     "name":"HISTORY.md",
                     "type":"file",
                     "path":"home/node_modules/range-parser/HISTORY.md",
                     "size":832
                  },
                  {
                     "name":"LICENSE",
                     "type":"file",
                     "path":"home/node_modules/range-parser/LICENSE",
                     "size":1178
                  },
                  {
                     "name":"README.md",
                     "type":"file",
                     "path":"home/node_modules/range-parser/README.md",
                     "size":1996
                  },
                  {
                     "name":"index.js",
                     "type":"file",
                     "path":"home/node_modules/range-parser/index.js",
                     "size":2805
                  },
                  {
                     "name":"package.json",
                     "type":"file",
                     "path":"home/node_modules/range-parser/package.json",
                     "size":3255
                  }
               ]
            },
            {
               "name":"send",
               "type":"folder",
               "path":"home/node_modules/send",
               "items":[
                  {
                     "name":"HISTORY.md",
                     "type":"file",
                     "path":"home/node_modules/send/HISTORY.md",
                     "size":10068
                  },
                  {
                     "name":"LICENSE",
                     "type":"file",
                     "path":"home/node_modules/send/LICENSE",
                     "size":1128
                  },
                  {
                     "name":"README.md",
                     "type":"file",
                     "path":"home/node_modules/send/README.md",
                     "size":8656
                  },
                  {
                     "name":"index.js",
                     "type":"file",
                     "path":"home/node_modules/send/index.js",
                     "size":22327
                  },
                  {
                     "name":"package.json",
                     "type":"file",
                     "path":"home/node_modules/send/package.json",
                     "size":3355
                  }
               ]
            }
         ]
      },
      {
         "name":"out",
         "type":"file",
         "path":"home/out",
         "size":19643
      },
      {
         "name":"package.json",
         "type":"file",
         "path":"home/package.json",
         "size":2763
      },
      {
         "name":"scan.js",
         "type":"file",
         "path":"home/scan.js",
         "size":1079
      }
   ]
};

$(function() {

    var filemanager = $('.filemanager'),
        breadcrumbs = $('.breadcrumbs'),
        fileList = filemanager.find('.data');

    // Start by fetching the file data from scan route with an AJAX request

    // $.get('scan', function(data) {
        data = myList;
        var response = [data];
        alert(JSON.stringify(response));
        var  currentPath = '',
            breadcrumbsUrls = [];
        var folders = [],
            files = [];
        // This event listener monitors changes on the URL. We use it to
        // capture back/forward navigation in the browser.

        $(window).on('hashchange', function() {

            goto(window.location.hash);

            // We are triggering the event. This will execute
            // this function on page load, so that we show the correct folder:

        }).trigger('hashchange');


        // Hiding and showing the search box

        filemanager.find('.search').click(function() {

            var search = $(this);

            search.find('span').hide();
            search.find('input[type=search]').show().focus();

        });


        // Listening for keyboard input on the search field.
        // We are using the "input" event which detects cut and paste
        // in addition to keyboard input.

        filemanager.find('input').on('input', function(e) {

            folders = [];
            files = [];

            var value = this.value.trim();

            if (value.length) {

                filemanager.addClass('searching');

                // Update the hash on every key stroke
                window.location.hash = 'search=' + value.trim();

            } else {

                filemanager.removeClass('searching');
                window.location.hash = encodeURIComponent(currentPath);

            }

        }).on('keyup', function(e) {

            // Clicking 'ESC' button triggers focusout and cancels the search

            var search = $(this);

            if (e.keyCode == 27) {

                search.trigger('focusout');

            }

        }).focusout(function(e) {

            // Cancel the search

            var search = $(this);

            if (!search.val().trim().length) {

                window.location.hash = encodeURIComponent(currentPath);
                search.hide();
                search.parent().find('span').show();

            }

        });


        // Clicking on folders

        fileList.on('click', 'li.folders', function(e) {
            e.preventDefault();

            var nextDir = $(this).find('a.folders').attr('href');

            if (filemanager.hasClass('searching')) {

                // Building the breadcrumbs

                breadcrumbsUrls = generateBreadcrumbs(nextDir);

                filemanager.removeClass('searching');
                filemanager.find('input[type=search]').val('').hide();
                filemanager.find('span').show();
            } else {
                breadcrumbsUrls.push(nextDir);
            }

            window.location.hash = encodeURIComponent(nextDir);
            currentPath = nextDir;
        });


        // Clicking on breadcrumbs

        breadcrumbs.on('click', 'a', function(e) {
            e.preventDefault();

            var index = breadcrumbs.find('a').index($(this)),
                nextDir = breadcrumbsUrls[index];

            breadcrumbsUrls.length = Number(index);

            window.location.hash = encodeURIComponent(nextDir);

        });


        // Navigates to the given hash (path)

        function goto(hash) {

            hash = decodeURIComponent(hash).slice(1).split('=');

            if (hash.length) {
                var rendered = '';

                // if hash has search in it

                if (hash[0] === 'search') {

                    filemanager.addClass('searching');
                    rendered = searchData(response, hash[1].toLowerCase());

                    if (rendered.length) {
                        currentPath = hash[0];
                        render(rendered);
                    } else {
                        render(rendered);
                    }

                }

                // if hash is some path
                else if (hash[0].trim().length) {

                    rendered = searchByPath(hash[0]);

                    if (rendered.length) {

                        currentPath = hash[0];
                        breadcrumbsUrls = generateBreadcrumbs(hash[0]);
                        render(rendered);

                    } else {
                        currentPath = hash[0];
                        breadcrumbsUrls = generateBreadcrumbs(hash[0]);
                        render(rendered);
                    }

                }

                // if there is no hash
                else {
                    currentPath = data.path;
                    breadcrumbsUrls.push(data.path);
                    render(searchByPath(data.path));
                }
            }
        }

        // Splits a file path and turns it into clickable breadcrumbs

        function generateBreadcrumbs(nextDir) {
            var path = nextDir.split('/').slice(0);
            for (var i = 1; i < path.length; i++) {
                path[i] = path[i - 1] + '/' + path[i];
            }
            return path;
        }


        // Locates a file by path

        function searchByPath(dir) {
            var path = dir.split('/'),
                demo = response,
                flag = 0;

            for (var i = 0; i < path.length; i++) {
                for (var j = 0; j < demo.length; j++) {
                    if (demo[j].name === path[i]) {
                        flag = 1;
                        demo = demo[j].items;
                        break;
                    }
                }
            }

            demo = flag ? demo : [];
            return demo;
        }


        // Recursively search through the file tree

        function searchData(data, searchTerms) {

            data.forEach(function(d) {
                if (d.type === 'folder') {

                    searchData(d.items, searchTerms);

                    if (d.name.toLowerCase().match(searchTerms)) {
                        folders.push(d);
                    }
                } else if (d.type === 'file') {
                    if (d.name.toLowerCase().match(searchTerms)) {
                        files.push(d);
                    }
                }
            });
            return {
                folders: folders,
                files: files
            };
        }


        // Render the HTML for the file manager

        function render(data) {

            var scannedFolders = [],
                scannedFiles = [];

            if (Array.isArray(data)) {

                data.forEach(function(d) {

                    if (d.type === 'folder') {
                        scannedFolders.push(d);
                    } else if (d.type === 'file') {
                        scannedFiles.push(d);
                    }

                });

            } else if (typeof data === 'object') {

                scannedFolders = data.folders;
                scannedFiles = data.files;

            }


            // Empty the old result and make the new one

            fileList.empty().hide();

            if (!scannedFolders.length && !scannedFiles.length) {
                filemanager.find('.nothingfound').show();
            } else {
                filemanager.find('.nothingfound').hide();
            }

            if (scannedFolders.length) {

                scannedFolders.forEach(function(f) {

                    var itemsLength = f.items.length,
                        name = escapeHTML(f.name),
                        icon = '<span class="icon folder"></span>';

                    if (itemsLength) {
                        icon = '<span class="icon folder full"></span>';
                    }

                    if (itemsLength == 1) {
                        itemsLength += ' item';
                    } else if (itemsLength > 1) {
                        itemsLength += ' items';
                    } else {
                        itemsLength = 'Empty';
                    }

                    var folder = $('<li class="folders"><a href="' + f.path + '" title="' + f.path + '" class="folders">' + icon + '<span class="name">' + name + '</span> <span class="details">' + itemsLength + '</span></a></li>');
                    folder.appendTo(fileList);
                });

            }

            if (scannedFiles.length) {

                scannedFiles.forEach(function(f) {

                    var fileSize = bytesToSize(f.size),
                        name = escapeHTML(f.name),
                        fileType = name.split('.'),
                        icon = '<span class="icon file"></span>';

                    fileType = fileType.length > 1 ? fileType[fileType.length - 1] : '';

                    icon = '<span class="icon file f-' + fileType + '">' + fileType + '</span>';

                    var file = $('<li class="files"><a href="' + f.path + '" title="' + f.path + '" class="files">' + icon + '<span class="name">' + name + '</span> <span class="details">' + fileSize + '</span></a></li>');
                    file.appendTo(fileList);
                });

            }


            // Generate the breadcrumbs

            var url = '';

            if (filemanager.hasClass('searching')) {

                url = '<span>Search results: </span>';
                fileList.removeClass('animated');

            } else {

                fileList.addClass('animated');

                breadcrumbsUrls.forEach(function(u, i) {

                    var name = u.split('/');

                    if (i !== breadcrumbsUrls.length - 1) {
                        url += '<a href="' + u + '"><span class="folderName">' + name[name.length - 1] + '</span></a> <span class="arrow">â†’</span> ';
                    } else {
                        url += '<span class="folderName">' + name[name.length - 1] + '</span>';
                    }

                });

            }

            breadcrumbs.text('').append(url);


            // Show the generated elements

            fileList.animate({
                'display': 'inline-block'
            });

        }


        // This function escapes special html characters in names
        function escapeHTML(unsafe) {
            return unsafe
                .replace(/&/g, "&amp;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;")
                .replace(/"/g, "&quot;")
                .replace(/'/g, "&#039;");
        }


        // Convert file sizes from bytes to human readable units

        function bytesToSize(bytes) {
            var sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];
            if (bytes === 0) return '0 Bytes';
            var i = parseInt(Math.floor(Math.log(bytes) / Math.log(1024)));
            return Math.round(bytes / Math.pow(1024, i), 2) + ' ' + sizes[i];
        }

    // });
});
