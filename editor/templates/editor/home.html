{% extends "editor/header.html" %}
{% block content %}
    <div >
        <h1 id="NITJheader">
            NITJ COMPILER</h1>
    </div>

    <div id="mainBlock">

        <div id="editorSpace">
            <div class="menuBar">

                <div class="inner">Save as:
                    <input type="text" id="fname" placeholder="File Name">
                </div>
                <div class="inner"><input type="submit" value="Save"></div>

                <div class="inner">
                    <select id="languageSelect" onchange="langChange(this);">
                        <option value="c">C</option>
                        <option value="cpp">C++</option>
                        <option value="java">Java</option>
                        <option value="py">Python</option>
                    </select>

                </div>
                <div class="inner"><input type='file' onchange='openFile(event)'>
                </div>
                <div class="inner"><input type="reset" value="Clear" onclick="resetCode()"></div>
                <div class=""></div>
                <br>
            </div>
            <div >
                <textarea id="codeEditor" name="code" rows="40" cols="62">//Your C code goes here</textarea>
            </div>

            <div class="statusBar">
                <div class="inner"><input type="button" id="Stdin" value="Stdin"></div>
                <div class="inner"><input type="button" id="execute" value="Execute"></div>
            </div>
        </div>
        <br>
        <textarea id="stdinput" placeholder="Enter your custom input" name="stdinput" rows="6" cols="80" style="display:none"></textarea>

        <span id="output" style="display:none">
            Output
        </span>
        <textarea id="stdoutput" name="stdout" rows="6" cols="80" style="display:none" disabled></textarea>

    </div>

    <script>
        var editor = CodeMirror.fromTextArea(document.getElementById("codeEditor"), {
            lineNumbers: true,
            matchBrackets: true,
            mode: "text/x-c"
        });

        //Detect changes in document window
        function onElementHeightChange(elm, callback) {
            var lastHeight = elm.clientHeight,
                newHeight;
            (function run() {
                newHeight = elm.clientHeight;
                if (lastHeight != newHeight)
                    callback();
                lastHeight = newHeight;

                if (elm.onElementHeightChangeTimer)
                    clearTimeout(elm.onElementHeightChangeTimer);

                elm.onElementHeightChangeTimer = setTimeout(run, 200);
            })();
        }

        onElementHeightChange(document.body, function () {
            window.scrollTo(0, document.body.scrollHeight);
        });

        //Fire onchange event automatically
        document.getElementById("languageSelect").onchange();

        function langChange(obj) {
            if (obj.value == "c") {
                editor.setOption("mode", "text/x-c");
                editor.setValue("/*\n  Your C code goes here\n  Main method should return 0\n*/");
                document.getElementById('fname').value = ''
            } else if (obj.value == "cpp") {
                document.getElementById('fname').value = ''
                editor.setOption("mode", "text/x-c++src");
                editor.setValue("/*\n  Your C++ code goes here\n  Main method should return 0\n*/");
            } else if (obj.value == "py") {
                document.getElementById('fname').value = ''
                editor.setOption("mode", "text/x-python")
                editor.setValue("#Your Python code goes here");
            } else if (obj.value == "java") {
                document.getElementById('fname').value = ''
                editor.setOption("mode", "text/x-java");
                editor.setValue("/*\n  Your Java code goes here\n  Name of class should be kept as main and public\n  If using a custom name to save the file, change the name of a class to the name of the program \n*/");
            }
        }
    </script>

{% endblock %}
